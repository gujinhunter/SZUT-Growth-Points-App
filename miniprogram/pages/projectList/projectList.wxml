<!--pages/projectList/projectList.wxml-->

<view class="container">
  <view wx:if="{{loading}}" class="loading">正在加载活动列表...</view>

  <block wx:for="{{activities}}" wx:key="category">
    <!-- 分类标题 -->
    <view class="category" bindtap="toggleCategory" data-category="{{item.category}}">
      <text class="category-title">{{item.category}}</text>
      <text class="arrow">{{activeCategory === item.category ? '▲' : '▼'}}</text>
    </view>

    <!-- 分类下的项目 -->
    <view wx:if="{{activeCategory === item.category}}" class="activity-list">
      <block wx:for="{{item.items}}" wx:key="name">

        <!-- ✅ 修改点①：将原先的 bindtap="showDetail" 改为 bindtap="goToApply" -->
        <!-- ✅ 修改点②：传递当前项目对象 data-item="{{item}}" -->
        <view class="activity-card" bindtap="goToApply" data-item="{{item}}">
          <view class="activity-name">{{item.name}}</view>
          <view class="activity-score">
            积分：
            <text class="score">
              {{Array.isArray(item.score) ? item.score.join('/') : item.score}}
            </text>点
          </view>
          <view class="activity-remark">{{item.remark}}</view>
        </view>

      </block>
    </view>
  </block>
</view>
