<!-- 背景层 -->
<view class="background">
  <!-- 使用 <image> 标签作为背景图，mode="aspectFill" 让图片自动填充全屏 -->
  <image src="/assets/bg-login.jpeg" mode="aspectFill" class="bg-img"></image>
</view>

<!-- 主内容容器 -->
<view class="container">
  <!-- 卡片区域：包含标题、登录按钮、绑定表单 -->
  <view class="card">
    <view class="card-header">
      <view class="title">欢迎使用助学信息平台</view>
      <button class="link-btn" size="mini" wx:if="{{!showAdminForm}}" bindtap="toggleAdminForm">管理员入口</button>
      <button class="link-btn" size="mini" wx:if="{{showAdminForm}}" bindtap="toggleAdminForm">返回学生入口</button>
    </view>

    <!-- 学生模式 -->
    <view wx:if="{{!showAdminForm}}">
      <button wx:if="{{!needBind}}" type="primary" class="login-btn" bindtap="checkProfile">
        微信一键登录并绑定
      </button>

      <view wx:if="{{needBind}}" class="bind-form">
        <view class="input-group">
          <text>姓名</text>
          <input value="{{name}}" bindinput="onNameInput" placeholder="请输入姓名" />
        </view>
        <view class="input-group">
          <text>学号</text>
          <input value="{{studentId}}" bindinput="onIdInput" placeholder="请输入学号" />
        </view>
        <view class="bind-tip">
          同一姓名与学号只能绑定一个微信账号，如需更换请联系管理员解绑。
        </view>
        <view wx:if="{{errorMessage}}" class="bind-error">
          {{errorMessage}}
        </view>
        <button class="bind-btn" bindtap="bindUser">确认绑定</button>
      </view>
    </view>

    <!-- 管理员模式 -->
    <view wx:if="{{showAdminForm}}" class="bind-form">
      <view class="input-group">
        <text>姓名</text>
        <input value="{{adminName}}" bindinput="onAdminNameInput" placeholder="请输入姓名" />
      </view>
      <view class="input-group">
        <text>工号</text>
        <input value="{{adminWorkId}}" bindinput="onAdminWorkIdInput" placeholder="请输入工号" />
      </view>
      <view wx:if="{{adminError}}" class="bind-error">
        {{adminError}}
      </view>
      <button class="bind-btn" bindtap="bindAdmin">绑定管理员</button>
    </view>
  </view>
</view>
